{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///index.js","webpack:///webpack/bootstrap cdf37e9d53edde25ce3a","webpack:///./src/History.ts","webpack:///./src/PathUtils.ts","webpack:///(webpack)/buildin/global.js","webpack:///./src/index.ts","webpack:///./src/LocationUtils.ts","webpack:///D:/workspace/web/my-router/node_modules/resolve-pathname/index.js","webpack:///./src/DOMUtils.ts","webpack:///./node_modules/timers-browserify/main.js","webpack:///./node_modules/setimmediate/setImmediate.js","webpack:///./node_modules/process/browser.js","webpack:///./src/Deferred.ts"],"names":["root","factory","exports","module","define","amd","self","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_defineProperty","obj","key","value","writable","_asyncToGenerator","fn","gen","apply","arguments","Promise","resolve","reject","step","arg","info","error","done","then","err","_classCallCheck","instance","Constructor","TypeError","_typeof","Symbol","iterator","constructor","_createClass","defineProperties","target","props","length","descriptor","protoProps","staticProps","LocationUtils_1","require","PathUtils_1","DOMUtils_1","Deferred_1","MY_ROUTER_HISTORY_WINDOW_INIT","locationKey","baseHistoryState","push","replace","goback","reload","MyHistory","_config","_window","undefined","window","_state","assign","type","hashChange","_stateStack","_notBusyDef","onBeforeChange","onChange","_win","Error","gobackName","insertRoot","_hashchangeHandler","bind","_initHistory","now","_gobackState","_pathToState","state","history","sessionStorage","_replaceState","_this","canUseDOM","timeStamp","Date","initialPath","_decodePath","_getHrefToPath","initialLocationState","isGobackNextLocation","_initGoback","_push","_stackTop","location","href","unshift","_initEventListener","_switchState","newState","_readonlyLocation","_execCallback","event","addEventListener","removeEventListener","stateType","_this3","handleCancell","result","_this2","isFalse","isFunction","nextTick","isCancelled","toReadonly","_ref","regeneratorRuntime","mark","_callee","path","data","newLocation","oldLocation","wrap","_context","prev","next","_checkData","sent","r","abrupt","t0","stop","_x2","_x3","_ref2","_callee2","_context2","_replace","_x4","_x5","_ref3","_callee3","discardLoctions","needInclude","index","_context3","_pathToLocation","findIndex","item","map","slice","reverse","_goback","_pushState","oldURL","_correct","back","_stateData","newURL","go","_ref4","_callee4","_context4","Deferred","promise","_x7","_x8","_ref5","_callee5","_context5","_x9","_x10","_ref6","_callee6","_context6","_x11","_ref7","_callee7","_context7","addLeadingSlash","hashIndex","indexOf","substring","JSON","stringify","isBusy","createLocation","parse","readonlyLocation","keys","forEach","set","_x15","_ref8","_callee8","tempTitle","_context8","document","title","_x17","_ref9","_callee9","_context9","pop","splice","Math","max","lastState","replaceState","_encodePath","pushState","console","hash","_checkState","destroy","_ref10","_callee11","goGoBackPage","_this4","_context11","_destroyEventListener","_ref11","_callee10","_context10","setTimeout","callback","_this5","_ref12","_callee12","_len","args","Array","_key","_context12","_this6","charAt","parsePath","pathname","search","substr","searchIndex","g","Function","eval","e","History_1","default","currentLocation","decodeURI","URIError","resolve_pathname_1","crateNo","_timeStamp","count","__webpack_exports__","isAbsolute","spliceOne","list","k","resolvePathname","to","from","toParts","split","fromParts","isToAbs","isFromAbs","mustEndAbs","concat","hasTrailingSlash","last","up","part","join","setImmediate","cb","ctx","MessageChannel","test","toString","channel","port","port2","port1","onmessage","postMessage","createElement","global","Timeout","id","clearFn","_id","_clearFn","scope","clearTimeout","setInterval","clearInterval","timeout","close","unref","ref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","clearImmediate","process","task","tasksByHandle","nextHandle","registerImmediate","handle","run","runIfPresent","currentlyRunningATask","doc","attachTo","getPrototypeOf","importScripts","postMessageIsAsynchronous","oldOnMessage","messagePrefix","random","onGlobalMessage","source","attachEvent","html","documentElement","script","onreadystatechange","removeChild","appendChild","defaultSetTimout","defaultClearTimeout","runTimeout","fun","cachedSetTimeout","runClearTimeout","marker","cachedClearTimeout","cleanUpNextTick","draining","currentQueue","queue","queueIndex","drainQueue","len","Item","array","noop","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","$isFinished","$resolve","$reject"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"my-router-history\"] = factory();\n\telse\n\t\troot[\"my-router-history\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"my-router-history\"] = factory();\n\telse\n\t\troot[\"my-router-history\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 3);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar LocationUtils_1 = __webpack_require__(4);\nvar PathUtils_1 = __webpack_require__(1);\nvar DOMUtils_1 = __webpack_require__(6);\nvar Deferred_1 = __webpack_require__(10);\nvar MY_ROUTER_HISTORY_GOBACK_INIT = 'MyRouterHistory:initGoback';\n// 记录MyHistory在默认window上的实例数，确保constructor仅能够运行一个实例\nvar MY_ROUTER_HISTORY_WINDOW_INIT = 'MyRouterHistory:window';\nvar locationKey = Symbol('location');\n/**\r\n * 用于mixin的基类\r\n */\nvar baseHistoryState = {\n    push: null,\n    replace: null,\n    goback: null,\n    reload: null\n};\n\nvar MyHistory = function () {\n    function MyHistory(_config) {\n        var _window = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : window;\n\n        _classCallCheck(this, MyHistory);\n\n        this._config = _config;\n        // 当前history的状态：\n        // 0未初始化    history没有完成初始化的时候\n        // 1正常        history正常运行中\n        // 2修正中      当用户手动修改hash，会被视为一次用户触发的跳转。此次跳转会先退回到goback页面，再前进回跳转的页面（为了保持history在浏览器中仅有两个浏览器记录——当前页面和退回页面），这个过程我们叫修改中\n        // 3返回中      当用户要求跳转回退，或者正在回退\n        // 4销毁中      在history销毁过程中的状态。\n        // 5退出中      当用户要求退出到系统以外，系统会一直触发goback，直到页面刷新为止\n        // 6跳转中      当用户要求跳转（包括push、replace、reload）\n        // 7跳转中      执行生命周期中\n        this._state = Object.assign({}, baseHistoryState, { type: 0, hashChange: function hashChange() {}\n        });\n        // 保存location数据的栈\n        this._stateStack = [];\n        /**\r\n         * 如果在beforeChange生命周期，出现了跳转，会在路由重新回归1的时候执行。\r\n         * 如果_notBusyDef已经存在，即使是在beforeChange生命周期（state为7）的时候，也不可以跳转\r\n         * @private\r\n         * @type {Deferred}\r\n         * @memberOf MyHistory\r\n         */\n        this._notBusyDef = null;\n        this.onBeforeChange = null;\n        this.onChange = null;\n        this._win = _window;\n        if (this._win[MY_ROUTER_HISTORY_WINDOW_INIT]) {\n            // 同一时刻，在默认的window上面，不允许有两个history实例运行\n            throw new Error('There are already other undestroyed history instances. Please destroy them before you can create a new history instance.');\n        }\n        this._config = Object.assign({ gobackName: 'go back', root: '/', insertRoot: true }, _config);\n        this._hashchangeHandler = this._hashchangeHandler.bind(this);\n        this._initHistory();\n    }\n\n    _createClass(MyHistory, [{\n        key: \"_initGoback\",\n\n        /**\r\n         * 初始化goback的location\r\n         * goback的location有2个作用：\r\n         * 1.用于监听用户的返回事件，当用户点击地址栏的返回按钮，会退回到goback的location。由goback去处理用户注册的goback事件\r\n         * 2.当用户手动修改浏览器的location的hash时候，history会增加一条location记录，这时候myhistory会先退回到goback的location，再前进到用户输入的lactation中，这样可以清除浏览器地址栏的前进按钮\r\n         * @private\r\n         * @param {number} now      初始化时候的时间戳\r\n         * @returns {boolean}       是否是goback处于上一页。返回false表示当前就是goback页面。\r\n         * @memberOf MyHistory\r\n         */\n        value: function _initGoback(now) {\n            // 先查看是否已经创建好了一个goback的location，因为浏览器中无法查看history对象里面保存的历史记录，所以使用history.state保存这个状态。\n            // state里面用于记录当前是否处于goback的下一页。\n            // 让goback比当前时间戳小，这样能够判断出是后退\n            this._gobackState = this._pathToState('/goback', undefined, 'GOBACK', now - 1);\n            var state = this._win.history.state;\n            if (state && state.type === 'GOBACK' && sessionStorage[MY_ROUTER_HISTORY_GOBACK_INIT]) {\n                // 如果当前页面是goback，表示goback已经初始化完成\n                return false;\n            } else if (state && state.type === 'NORMAL' && sessionStorage[MY_ROUTER_HISTORY_GOBACK_INIT]) {\n                // 因为目前还处于goback页面，所有返回false\n                return true;\n            } else {\n                sessionStorage[MY_ROUTER_HISTORY_GOBACK_INIT] = true;\n                this._replaceState(this._gobackState);\n                return false;\n            }\n        }\n        // 初始化URL\n\n    }, {\n        key: \"_initHistory\",\n        value: function _initHistory() {\n            var _this = this;\n\n            // 创建hash路由\n            if (!DOMUtils_1.canUseDOM) {\n                throw new Error('Hash history needs a DOM');\n            }\n            // 获取当前时间戳\n            var timeStamp = Date.now();\n            // 获取当前的路径，将其转换为合法路径后，\n            var initialPath = this._decodePath(this._getHrefToPath());\n            var initialLocationState = this._pathToState(initialPath, undefined, 'NORMAL', timeStamp);\n            // 初始化goback\n            var isGobackNextLocation = this._initGoback(timeStamp);\n            // 将当前路径压入栈中\n            this._push(initialLocationState, !isGobackNextLocation);\n            // 如果第一个节点不等于根的路径，插入根节点到栈底\n            if (this._config.insertRoot && this._stackTop.location.href !== this._config.root) {\n                this._stateStack.unshift(this._pathToState(this._config.root, undefined, 'NORMAL', timeStamp));\n            }\n            // 初始化监听器\n            this._initEventListener();\n            // 全部初始化完成，记录初始化成功\n            this._win[MY_ROUTER_HISTORY_WINDOW_INIT] = true;\n            this._switchState(1);\n            // 使用微队列，用于异步初始化\n            Promise.resolve().then(function () {\n                var newState = _this._readonlyLocation(initialLocationState);\n                _this._execCallback(_this.onChange)('init', null, newState, [], [newState]);\n            });\n        }\n        /**\r\n         * 注册到HashChange事件的监听器。这个函数会在构造器中bind，以在addEventListener保持this不变\r\n         * @private\r\n         * @param {HashChangeEvent} event\r\n         * @memberOf MyHistory\r\n         */\n\n    }, {\n        key: \"_hashchangeHandler\",\n        value: function _hashchangeHandler(event) {\n            this._state.hashChange(event);\n        }\n    }, {\n        key: \"_initEventListener\",\n        value: function _initEventListener() {\n            // 注册\n            this._win.addEventListener('hashchange', this._hashchangeHandler);\n        }\n    }, {\n        key: \"_destroyEventListener\",\n        value: function _destroyEventListener() {\n            this._win.removeEventListener('hashchange', this._hashchangeHandler);\n        }\n        /**\r\n         * 切换状态\r\n         * @private\r\n         * @param {any} stateType\r\n         * @memberOf MyHistory\r\n         */\n\n    }, {\n        key: \"_switchState\",\n        value: function _switchState(stateType) {\n            var _this3 = this;\n\n            // 处理beforeChange中的取消逻辑。如果用户返回false、Error、Function都视为取消跳转。其中Function会在跳转结束后自执行\n            var handleCancell = function handleCancell(result) {\n                var _this2 = this;\n\n                var isFalse = result === false,\n                    isFunction = typeof result === 'function';\n                if (isFalse || isFunction) {\n                    // 这里用任务队列而不用微任务队列，希望整个promise执行完再执行result\n                    if (isFunction) {\n                        DOMUtils_1.nextTick(function () {\n                            result.call(_this2);\n                        });\n                    }\n                    // 抛出用户取消异常\n                    var error = new Error('User cancelled');\n                    error.isCancelled = true;\n                    throw error;\n                } else if (result instanceof Error) {\n                    throw result;\n                }\n            };\n            // 简单原型函数名，增加压缩效率\n            var toReadonly = this._readonlyLocation.bind(this);\n            switch (stateType) {\n                case 1:\n                    this._state = {\n                        type: 1,\n                        push: function () {\n                            var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(path, data) {\n                                var state, newLocation, oldLocation, result;\n                                return regeneratorRuntime.wrap(function _callee$(_context) {\n                                    while (1) {\n                                        switch (_context.prev = _context.next) {\n                                            case 0:\n                                                _this3._checkData(data);\n                                                // 先切换到状态6，保护在跳转过程中不受其他操作影响\n                                                _this3._switchState(6);\n                                                _context.prev = 2;\n                                                state = _this3._pathToState(path, data, 'NORMAL');\n                                                newLocation = toReadonly(state);\n                                                oldLocation = toReadonly(_this3._stackTop);\n                                                _context.next = 8;\n                                                return _this3._execCallback(_this3.onBeforeChange)('push', oldLocation, newLocation, [], [newLocation]);\n\n                                            case 8:\n                                                result = _context.sent;\n\n                                                // 处理取消情况\n                                                handleCancell(result);\n                                                _this3._push(state);\n                                                // 确保跳转完成\n                                                _context.next = 13;\n                                                return new Promise(function (r) {\n                                                    return DOMUtils_1.nextTick(r);\n                                                });\n\n                                            case 13:\n                                                _context.next = 15;\n                                                return _this3._execCallback(_this3.onChange)('push', oldLocation, newLocation, [], [newLocation]);\n\n                                            case 15:\n                                                _this3._switchState(1);\n                                                return _context.abrupt(\"return\", _this3._readonlyLocation(state));\n\n                                            case 19:\n                                                _context.prev = 19;\n                                                _context.t0 = _context[\"catch\"](2);\n\n                                                // 完成后切换状态1\n                                                _this3._switchState(1);\n                                                throw _context.t0;\n\n                                            case 23:\n                                            case \"end\":\n                                                return _context.stop();\n                                        }\n                                    }\n                                }, _callee, _this3, [[2, 19]]);\n                            }));\n\n                            return function push(_x2, _x3) {\n                                return _ref.apply(this, arguments);\n                            };\n                        }(),\n                        replace: function () {\n                            var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(path, data) {\n                                var now, state, newLocation, oldLocation, result;\n                                return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                                    while (1) {\n                                        switch (_context2.prev = _context2.next) {\n                                            case 0:\n                                                _this3._checkData(data);\n                                                _this3._switchState(6);\n                                                _context2.prev = 2;\n                                                now = Date.now();\n                                                state = _this3._pathToState(path, data, 'NORMAL', now);\n                                                newLocation = toReadonly(state);\n                                                oldLocation = toReadonly(_this3._stackTop);\n                                                _context2.next = 9;\n                                                return _this3._execCallback(_this3.onBeforeChange)('replace', oldLocation, newLocation, [oldLocation], [newLocation]);\n\n                                            case 9:\n                                                result = _context2.sent;\n\n                                                // 处理取消情况\n                                                handleCancell(result);\n                                                _this3._replace(state);\n                                                // 确保跳转完成\n                                                _context2.next = 14;\n                                                return new Promise(function (r) {\n                                                    return DOMUtils_1.nextTick(r);\n                                                });\n\n                                            case 14:\n                                                _this3._switchState(1);\n                                                _context2.next = 17;\n                                                return _this3._execCallback(_this3.onChange)('replace', oldLocation, newLocation, [oldLocation], [newLocation]);\n\n                                            case 17:\n                                                return _context2.abrupt(\"return\", _this3._readonlyLocation(state));\n\n                                            case 20:\n                                                _context2.prev = 20;\n                                                _context2.t0 = _context2[\"catch\"](2);\n\n                                                // 完成后切换状态1\n                                                _this3._switchState(1);\n                                                throw _context2.t0;\n\n                                            case 24:\n                                            case \"end\":\n                                                return _context2.stop();\n                                        }\n                                    }\n                                }, _callee2, _this3, [[2, 20]]);\n                            }));\n\n                            return function replace(_x4, _x5) {\n                                return _ref2.apply(this, arguments);\n                            };\n                        }(),\n                        goback: function () {\n                            var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n                                var n = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n                                var oldLocation, discardLoctions, newState, newLocation, needInclude, fn, index, result;\n                                return regeneratorRuntime.wrap(function _callee3$(_context3) {\n                                    while (1) {\n                                        switch (_context3.prev = _context3.next) {\n                                            case 0:\n                                                // 先执行生命周期\n                                                _this3._switchState(3);\n                                                _context3.prev = 1;\n\n                                                // 当前页面\n                                                oldLocation = void 0;\n                                                // 丢弃的页面\n\n                                                discardLoctions = void 0;\n                                                // 退回到的页面\n\n                                                newState = void 0;\n                                                // 新建页面\n\n                                                newLocation = void 0;\n                                                // 是否有符合退回条件的页面，如果没有插入一条\n\n                                                needInclude = false;\n                                                // 判断是否符合页面的条件\n\n                                                fn = void 0;\n\n                                                if (!(typeof n === 'number')) {\n                                                    _context3.next = 16;\n                                                    break;\n                                                }\n\n                                                if (!(n <= 0)) {\n                                                    _context3.next = 13;\n                                                    break;\n                                                }\n\n                                                return _context3.abrupt(\"return\", null);\n\n                                            case 13:\n                                                if (n >= _this3._stateStack.length) {\n                                                    fn = function fn() {\n                                                        return false;\n                                                    };\n                                                } else {\n                                                    fn = function fn(location, index) {\n                                                        return _this3._stateStack.length - index - 1 === n;\n                                                    };\n                                                }\n\n                                            case 14:\n                                                _context3.next = 17;\n                                                break;\n\n                                            case 16:\n                                                if (typeof n === 'string') {\n                                                    // 查询有没有href等于n的页面，如果没有就退回到起点，然后插入一条记录\n                                                    fn = function fn(location) {\n                                                        return location.href === _this3._pathToLocation(n).href;\n                                                    };\n                                                } else if (typeof n === 'function') {\n                                                    fn = n;\n                                                }\n\n                                            case 17:\n                                                index = _this3._stateStack.findIndex(function (item, index) {\n                                                    return fn(toReadonly(item), index);\n                                                });\n\n                                                oldLocation = toReadonly(_this3._stackTop);\n                                                if (index === -1) {\n                                                    // 如果没有找到，就插入一条根节点进去。但是如果查询的是指定页面，就将指定页面放进去\n                                                    newState = _this3._pathToState(_this3._pathToLocation(typeof n === 'string' ? n : _this3._config.root), 'NORMAL', undefined);\n                                                    newLocation = toReadonly(newState);\n                                                    discardLoctions = _this3._stateStack.map(function (item) {\n                                                        return toReadonly(item);\n                                                    });\n                                                    needInclude = true;\n                                                } else {\n                                                    // 取出退回位置的state\n                                                    newState = _this3._stateStack[index];\n                                                    newLocation = toReadonly(newState);\n                                                    discardLoctions = _this3._stateStack.slice(index + 1).map(function (item) {\n                                                        return toReadonly(item);\n                                                    }).reverse();\n                                                }\n                                                _context3.next = 22;\n                                                return _this3._execCallback(_this3.onBeforeChange)('goback', oldLocation, newLocation, discardLoctions, needInclude ? [newLocation] : []);\n\n                                            case 22:\n                                                result = _context3.sent;\n\n                                                // 处理取消情况\n                                                handleCancell(result);\n                                                _this3._goback(discardLoctions.length, needInclude ? newState : null, false);\n                                                // 确保跳转完成\n                                                _context3.next = 27;\n                                                return new Promise(function (r) {\n                                                    return DOMUtils_1.nextTick(r);\n                                                });\n\n                                            case 27:\n                                                _this3._switchState(1);\n                                                _context3.next = 30;\n                                                return _this3._execCallback(_this3.onChange)('goback', oldLocation, newLocation, discardLoctions, needInclude ? [newLocation] : []);\n\n                                            case 30:\n                                                return _context3.abrupt(\"return\", _this3._readonlyLocation(newState));\n\n                                            case 33:\n                                                _context3.prev = 33;\n                                                _context3.t0 = _context3[\"catch\"](1);\n\n                                                // 完成后切换状态1\n                                                _this3._switchState(1);\n                                                throw _context3.t0;\n\n                                            case 37:\n                                            case \"end\":\n                                                return _context3.stop();\n                                        }\n                                    }\n                                }, _callee3, _this3, [[1, 33]]);\n                            }));\n\n                            return function goback() {\n                                return _ref3.apply(this, arguments);\n                            };\n                        }(),\n                        reload: function reload() {\n                            return _this3._state.replace(_this3._stackTop.location.href);\n                        },\n                        hashChange: function hashChange(event) {\n                            var state = _this3._win.history.state;\n                            if (state && state.type === 'GOBACK') {\n                                // 用户手动退回，前进一个页面，让history的修正\n                                _this3._pushState(_this3._stackTop);\n                                _this3._state.goback(1);\n                            } else if (!state && _this3._getHrefToPath(event.oldURL) === _this3._stateStack[_this3._stateStack.length - 1].location.href) {\n                                // 判断是否是用户手动修改hash跳转，或者a标签切换hash。判断方法如下：\n                                // 1.当前history没有state，或者state不等于State变量\n                                // 2.oldURL等于当前_stateStack栈顶的href（即使这样也不能确定该页面是从系统页面栈顶跳转过来的，但是没有其他更好的方式）\n                                // 先切户到手动修正用户修改url的状态2，保留用户要跳转的url\n                                _this3._switchState(2);\n                                _this3._stateData = _this3._getHrefToPath(event.newURL);\n                                // 后退两次，退回到goback页面\n                                _this3._win.history.go(-2);\n                            } else {\n                                // 如果不是从栈顶的url转跳转到该状态，就无法确定返回页面就在当前页面的前面，因此触发修正\n                                _this3._correct();\n                                // 纠正后重新后退\n                                _this3._win.history.back();\n                            }\n                        }\n                    };\n                    // 重新置回1，设置_notBusyDef为resolve\n                    if (this._notBusyDef) {\n                        this._notBusyDef.resolve(undefined);\n                        this._notBusyDef = null;\n                    }\n                    break;\n                case 2:\n                    this._state = Object.assign({ type: 2 }, baseHistoryState, { hashChange: function hashChange(event) {\n                            // 对纠正的处理步骤\n                            // 1. 一直后退，直到后退到goback页面\n                            // 2. 前进到gobackNext页面，把用户给出的地址放到gobackNext页面中。\n                            var state = _this3._win.history.state;\n                            if (state && state.type === 'NORMAL') {\n                                // 如果当前处于gobackNext页面，表示上一页就是goback，则退回，这主要是为了修改ios的safari那种无法使用go(-2)的浏览器时候的处理方式\n                                _this3._win.history.back();\n                            } else if (state && state.type === 'GOBACK') {\n                                // 如果已经在goback页面了，则跳转到用户手输入的地址\n                                var now = Date.now();\n                                var _location = _this3._pathToLocation(_this3._stateData, now);\n                                // 切回正在状态，这样就完成了对页面的修正\n                                _this3._switchState(1);\n                                _this3._pushState(_this3._stackTop);\n                                _this3._state.push(_location.href);\n                            } else {\n                                // 在纠正的时候，如果跳转到了goback和gobackNext以外的页面，视为异常，进行异常纠正\n                                _this3._correct();\n                                // 纠正后重新后退\n                                _this3._win.history.back();\n                            }\n                        } });\n                    break;\n                case 3:\n                case 6:\n                    this._state = Object.assign({ type: stateType }, baseHistoryState, { hashChange: function hashChange(event) {\n                            if (!_this3._win.history.state && _this3._getHrefToPath(event.oldURL) === _this3._stateStack[_this3._stateStack.length - 1].location.href) {\n                                // 如果用户在此期间手动修改url，直接纠正\n                                _this3._correct();\n                            } else {\n                                // 用户手动退回，前进一个页面，让history的修正\n                                _this3._pushState(_this3._stackTop);\n                            }\n                        } });\n                    break;\n                case 4:\n                case 5:\n                    this._state = Object.assign({ type: stateType }, baseHistoryState, { hashChange: function hashChange(event) {\n                            _this3._win.history.back();\n                        } });\n                    break;\n                case 7:\n                    this._state = {\n                        type: stateType,\n                        hashChange: function hashChange(event) {\n                            _this3._win.history.back();\n                        },\n                        push: function () {\n                            var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(path, state) {\n                                return regeneratorRuntime.wrap(function _callee4$(_context4) {\n                                    while (1) {\n                                        switch (_context4.prev = _context4.next) {\n                                            case 0:\n                                                _this3._notBusyDef = new Deferred_1.Deferred();\n                                                return _context4.abrupt(\"return\", _this3._notBusyDef.promise.then(function () {\n                                                    return _this3.push(path, state);\n                                                }));\n\n                                            case 2:\n                                            case \"end\":\n                                                return _context4.stop();\n                                        }\n                                    }\n                                }, _callee4, _this3);\n                            }));\n\n                            return function push(_x7, _x8) {\n                                return _ref4.apply(this, arguments);\n                            };\n                        }(),\n                        replace: function () {\n                            var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(path, state) {\n                                return regeneratorRuntime.wrap(function _callee5$(_context5) {\n                                    while (1) {\n                                        switch (_context5.prev = _context5.next) {\n                                            case 0:\n                                                _this3._notBusyDef = new Deferred_1.Deferred();\n                                                return _context5.abrupt(\"return\", _this3._notBusyDef.promise.then(function () {\n                                                    return _this3.replace(path, state);\n                                                }));\n\n                                            case 2:\n                                            case \"end\":\n                                                return _context5.stop();\n                                        }\n                                    }\n                                }, _callee5, _this3);\n                            }));\n\n                            return function replace(_x9, _x10) {\n                                return _ref5.apply(this, arguments);\n                            };\n                        }(),\n                        goback: function () {\n                            var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6(arg) {\n                                return regeneratorRuntime.wrap(function _callee6$(_context6) {\n                                    while (1) {\n                                        switch (_context6.prev = _context6.next) {\n                                            case 0:\n                                                _this3._notBusyDef = new Deferred_1.Deferred();\n                                                return _context6.abrupt(\"return\", _this3._notBusyDef.promise.then(function () {\n                                                    return _this3.goback(arg);\n                                                }));\n\n                                            case 2:\n                                            case \"end\":\n                                                return _context6.stop();\n                                        }\n                                    }\n                                }, _callee6, _this3);\n                            }));\n\n                            return function goback(_x11) {\n                                return _ref6.apply(this, arguments);\n                            };\n                        }(),\n                        reload: function () {\n                            var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7() {\n                                return regeneratorRuntime.wrap(function _callee7$(_context7) {\n                                    while (1) {\n                                        switch (_context7.prev = _context7.next) {\n                                            case 0:\n                                                _this3._notBusyDef = new Deferred_1.Deferred();\n                                                return _context7.abrupt(\"return\", _this3._notBusyDef.promise.then(function () {\n                                                    return _this3.reload();\n                                                }));\n\n                                            case 2:\n                                            case \"end\":\n                                                return _context7.stop();\n                                        }\n                                    }\n                                }, _callee7, _this3);\n                            }));\n\n                            return function reload() {\n                                return _ref7.apply(this, arguments);\n                            };\n                        }()\n                    };\n                    break;\n            }\n        }\n        /**\r\n         * 将用户给定的path转为系统显示的path\r\n         * @private\r\n         * @param {string} path         用户给定的path\r\n         * @returns {string}            系统显示的path\r\n         * @memberOf MyHistory\r\n         */\n\n    }, {\n        key: \"_encodePath\",\n        value: function _encodePath(path) {\n            return PathUtils_1.addLeadingSlash(path);\n        }\n        /**\r\n         * 将系统显示的path转为用户给定的path\r\n         * @private\r\n         * @param {string} path         系统显示的path\r\n         * @returns {string}            用户给定的path\r\n         * @memberOf MyHistory\r\n         */\n\n    }, {\n        key: \"_decodePath\",\n        value: function _decodePath(path) {\n            return PathUtils_1.addLeadingSlash(path);\n        }\n        // 获取hash中保存的路径。\n\n    }, {\n        key: \"_getHrefToPath\",\n        value: function _getHrefToPath() {\n            var href = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._win.location.href;\n\n            // We can't use window.location.hash here because it's not\n            // consistent across browsers - Firefox will pre-decode it!\n            var hashIndex = href.indexOf('#');\n            return hashIndex === -1 ? '' : href.substring(hashIndex + 1);\n        }\n        // 检查data，确保data可以序列化\n\n    }, {\n        key: \"_checkData\",\n        value: function _checkData(data) {\n            if (data != null) {\n                JSON.stringify(data);\n            }\n        }\n        // 检查路由是否处于可以跳转状态（state为1或7，如果处于7仅能跳转1次）\n\n    }, {\n        key: \"_checkState\",\n        value: function _checkState() {\n            if (this.isBusy) {\n                var error = new Error('MyHistory busy');\n                error.isBusy = true;\n                throw error;\n            }\n        }\n        /**\r\n         * 将给定的path封装成一个location\r\n         * @private\r\n         * @param {string} path\r\n         * @param {number} [timeStamp=Date.now()]\r\n         * @returns\r\n         * @memberOf MyHistory\r\n         */\n\n    }, {\n        key: \"_pathToLocation\",\n        value: function _pathToLocation(path) {\n            var timeStamp = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Date.now();\n\n            path = this._decodePath(path);\n            // 创建的location\n            return LocationUtils_1.createLocation(path, timeStamp + '');\n        }\n    }, {\n        key: \"_pathToState\",\n        value: function _pathToState(path) {\n            var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n            var type = arguments[2];\n            var timeStamp = arguments[3];\n\n            var location = void 0;\n            if ((typeof path === \"undefined\" ? \"undefined\" : _typeof(path)) === 'object') {\n                location = path;\n            } else {\n                location = this._pathToLocation(path, timeStamp);\n            }\n            return {\n                location: location,\n                type: type,\n                timeStamp: timeStamp,\n                data: JSON.parse(JSON.stringify(data))\n            };\n        }\n    }, {\n        key: \"_readonlyLocation\",\n        value: function _readonlyLocation(state) {\n            var data = state.data;\n            var location = Object.assign({}, state.location, { state: data });\n            // 只读对象\n            var readonlyLocation = _defineProperty({}, locationKey, location);\n            // 通过只设置getter不设置setter实现只读。不使用freeze是因为freeze在严格模式下赋值会抛出错误。\n            Object.keys(location).forEach(function (key) {\n                Object.defineProperty(readonlyLocation, key, {\n                    get: function get() {\n                        return this[locationKey][key];\n                    },\n                    set: function set() {},\n\n                    enumerable: true\n                });\n            });\n            return readonlyLocation;\n        }\n    }, {\n        key: \"_push\",\n        value: function () {\n            var _ref8 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(state) {\n                var push = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n                var tempTitle;\n                return regeneratorRuntime.wrap(function _callee8$(_context8) {\n                    while (1) {\n                        switch (_context8.prev = _context8.next) {\n                            case 0:\n                                if (push) {\n                                    tempTitle = this._win.document.title;\n                                    // 修改title为gobackName，这样地址栏显示的时候会是一个给定的gobackName，而不是页面的title\n\n                                    this._win.document.title = this._config.gobackName;\n                                    this._pushState(state);\n                                    this._win.document.title = tempTitle;\n                                } else {\n                                    this._replaceState(state);\n                                }\n                                this._stateStack.push(state);\n\n                            case 2:\n                            case \"end\":\n                                return _context8.stop();\n                        }\n                    }\n                }, _callee8, this);\n            }));\n\n            function _push(_x15) {\n                return _ref8.apply(this, arguments);\n            }\n\n            return _push;\n        }()\n    }, {\n        key: \"_replace\",\n        value: function () {\n            var _ref9 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9(state) {\n                var push = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n                var tempTitle;\n                return regeneratorRuntime.wrap(function _callee9$(_context9) {\n                    while (1) {\n                        switch (_context9.prev = _context9.next) {\n                            case 0:\n                                this._stateStack.pop();\n                                this._stateStack.push(state);\n                                if (push) {\n                                    tempTitle = this._win.document.title;\n                                    // 修改title为gobackName，这样地址栏显示的时候会是一个给定的gobackName，而不是页面的title\n\n                                    this._win.document.title = this._config.gobackName;\n                                    this._pushState(state);\n                                    this._win.document.title = tempTitle;\n                                } else {\n                                    this._replaceState(state);\n                                }\n\n                            case 3:\n                            case \"end\":\n                                return _context9.stop();\n                        }\n                    }\n                }, _callee9, this);\n            }));\n\n            function _replace(_x17) {\n                return _ref9.apply(this, arguments);\n            }\n\n            return _replace;\n        }()\n    }, {\n        key: \"_goback\",\n        value: function _goback(n) {\n            var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n            var push = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n            if (n <= 0) {\n                return;\n            }\n            this._stateStack.splice(Math.max(0, this._stateStack.length - n));\n            if (state) {\n                this._stateStack.push(state);\n            }\n            var lastState = this._stateStack[this._stateStack.length - 1];\n            if (push) {\n                this._pushState(lastState);\n            } else {\n                this._replaceState(lastState);\n            }\n        }\n    }, {\n        key: \"_replaceState\",\n        value: function _replaceState(state) {\n            this._win.history.replaceState(state, null, '#' + this._encodePath(state.location.href));\n        }\n    }, {\n        key: \"_pushState\",\n        value: function _pushState(state) {\n            this._win.history.pushState(state, null, '#' + this._encodePath(state.location.href));\n        }\n        /**\r\n         * 当用处于未知页面（既不是goback页面，也不是normal页面时候），触发纠正\r\n         */\n\n    }, {\n        key: \"_correct\",\n        value: function _correct() {\n            // 暂时先记录日志\n            console.error('异常', this._stateStack, this._win.history.state, location.hash);\n            // 初始化goback\n            var isGobackNextLocation = this._initGoback(this._gobackState.timeStamp);\n            // 初始化当前页面\n            this._push(this._stackTop, !isGobackNextLocation);\n        }\n    }, {\n        key: \"push\",\n        value: function push(path, data) {\n            this._checkState();\n            return this._state.push(path, data);\n        }\n    }, {\n        key: \"replace\",\n        value: function replace(path, data) {\n            this._checkState();\n            return this._state.replace(path, data);\n        }\n    }, {\n        key: \"goback\",\n        value: function goback(n) {\n            this._checkState();\n            return this._state.goback(n);\n        }\n    }, {\n        key: \"reload\",\n        value: function reload() {\n            this._checkState();\n            return this._state.reload();\n        }\n    }, {\n        key: \"destroy\",\n        value: function () {\n            var _ref10 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11() {\n                var _this4 = this;\n\n                var error, goGoBackPage;\n                return regeneratorRuntime.wrap(function _callee11$(_context11) {\n                    while (1) {\n                        switch (_context11.prev = _context11.next) {\n                            case 0:\n                                this._destroyEventListener();\n                                this.onBeforeChange = null;\n                                this.onChange = null;\n                                if (this._notBusyDef) {\n                                    error = new Error('User cancelled');\n\n                                    error.isCancelled = true;\n                                    this._notBusyDef.reject(error);\n                                    this._notBusyDef = null;\n                                }\n                                sessionStorage[MY_ROUTER_HISTORY_GOBACK_INIT] = false;\n\n                                goGoBackPage = function () {\n                                    var _ref11 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10() {\n                                        return regeneratorRuntime.wrap(function _callee10$(_context10) {\n                                            while (1) {\n                                                switch (_context10.prev = _context10.next) {\n                                                    case 0:\n                                                        if (!(_this4._win.history.state && _this4._win.history.state.type === 'NORMAL')) {\n                                                            _context10.next = 8;\n                                                            break;\n                                                        }\n\n                                                        _this4._win.history.back();\n                                                        _context10.next = 4;\n                                                        return new Promise(function (r) {\n                                                            return setTimeout(r, 50);\n                                                        });\n\n                                                    case 4:\n                                                        _context10.next = 6;\n                                                        return goGoBackPage();\n\n                                                    case 6:\n                                                        _context10.next = 19;\n                                                        break;\n\n                                                    case 8:\n                                                        if (!_this4._win.history.state) {\n                                                            _context10.next = 17;\n                                                            break;\n                                                        }\n\n                                                        _this4._win.history.replaceState(null, null, '#' + _this4._stackTop.location.href);\n                                                        _this4._win.location.hash = '#' + _this4._stackTop.location.href;\n                                                        _context10.next = 13;\n                                                        return new Promise(function (r) {\n                                                            return setTimeout(r, 50);\n                                                        });\n\n                                                    case 13:\n                                                        _context10.next = 15;\n                                                        return goGoBackPage();\n\n                                                    case 15:\n                                                        _context10.next = 19;\n                                                        break;\n\n                                                    case 17:\n                                                        _context10.next = 19;\n                                                        return new Promise(function (r) {\n                                                            return setTimeout(r, 50);\n                                                        });\n\n                                                    case 19:\n                                                    case \"end\":\n                                                        return _context10.stop();\n                                                }\n                                            }\n                                        }, _callee10, _this4);\n                                    }));\n\n                                    return function goGoBackPage() {\n                                        return _ref11.apply(this, arguments);\n                                    };\n                                }();\n\n                                _context11.next = 8;\n                                return goGoBackPage();\n\n                            case 8:\n                                // 延时，等pushState执行完\n                                this._stateStack = null;\n                                this._config = null;\n                                this._stateData = null;\n                                this._state = null;\n                                if (this._win === window) {\n                                    delete this._win[MY_ROUTER_HISTORY_WINDOW_INIT];\n                                }\n                                this._win = null;\n\n                            case 14:\n                            case \"end\":\n                                return _context11.stop();\n                        }\n                    }\n                }, _callee11, this);\n            }));\n\n            function destroy() {\n                return _ref10.apply(this, arguments);\n            }\n\n            return destroy;\n        }()\n    }, {\n        key: \"_execCallback\",\n        value: function _execCallback(callback) {\n            var _this5 = this;\n\n            if (typeof callback === 'function') {\n                return function () {\n                    var _ref12 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee12() {\n                        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                            args[_key] = arguments[_key];\n                        }\n\n                        var state, result;\n                        return regeneratorRuntime.wrap(function _callee12$(_context12) {\n                            while (1) {\n                                switch (_context12.prev = _context12.next) {\n                                    case 0:\n                                        state = _this5._state.type;\n                                        _context12.prev = 1;\n\n                                        _this5._switchState(7);\n                                        _context12.next = 5;\n                                        return callback.apply(_this5, args);\n\n                                    case 5:\n                                        result = _context12.sent;\n\n                                        _this5._switchState(state);\n                                        return _context12.abrupt(\"return\", result);\n\n                                    case 10:\n                                        _context12.prev = 10;\n                                        _context12.t0 = _context12[\"catch\"](1);\n\n                                        _this5._switchState(state);\n                                        throw _context12.t0;\n\n                                    case 14:\n                                    case \"end\":\n                                        return _context12.stop();\n                                }\n                            }\n                        }, _callee12, _this5, [[1, 10]]);\n                    }));\n\n                    return function () {\n                        return _ref12.apply(this, arguments);\n                    };\n                }();\n            } else {\n                return function () {\n                    return Promise.resolve();\n                };\n            }\n        }\n    }, {\n        key: \"_stackTop\",\n        get: function get() {\n            if (this._stateStack.length) {\n                return this._stateStack[this._stateStack.length - 1];\n            } else {\n                return null;\n            }\n        }\n    }, {\n        key: \"stack\",\n        get: function get() {\n            var _this6 = this;\n\n            return this._stateStack.map(function (state) {\n                return _this6._readonlyLocation(state);\n            });\n        }\n    }, {\n        key: \"length\",\n        get: function get() {\n            return this._stateStack.length;\n        }\n    }, {\n        key: \"isBusy\",\n        get: function get() {\n            return this._state.type !== 1 && this._state.type !== 7 || this._notBusyDef && this._state.type === 7;\n        }\n    }, {\n        key: \"location\",\n        get: function get() {\n            return this._readonlyLocation(this._stackTop);\n        }\n    }]);\n\n    return MyHistory;\n}();\n\nexports.MyHistory = MyHistory;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\r\n * 增加'/'到path\r\n * @export\r\n * @param {string} path\r\n * @returns {string}\r\n */\nfunction addLeadingSlash(path) {\n    return path.charAt(0) === '/' ? path : '/' + path;\n}\nexports.addLeadingSlash = addLeadingSlash;\n// /**\n//  * 移除path的根'/'\n//  * @export\n//  * @param {string} path\n//  * @returns {string}\n//  */\n// export function stripLeadingSlash(path: string): string {\n//     return path.charAt(0) === '/' ? path.substr(1) : path;\n// }\n// /**\n//  * 移除path最后的'/'\n//  * @export\n//  * @param {string} path\n//  * @returns {string}\n//  */\n// export function stripTrailingSlash(path: string): string {\n//     return path.charAt(path.length - 1) === '/' ? path.slice(0, -1) : path;\n// }\n/**\r\n * 将一个path转为location对象形式\r\n * @export\r\n * @param {string} path\r\n * @param {any} state\r\n * @returns {ILocation}\r\n */\nfunction parsePath(path) {\n    var pathname = path || '/';\n    var search = '';\n    var hash = '';\n    var hashIndex = pathname.indexOf('#');\n    if (hashIndex !== -1) {\n        hash = pathname.substr(hashIndex);\n        pathname = pathname.substr(0, hashIndex);\n    }\n    var searchIndex = pathname.indexOf('?');\n    if (searchIndex !== -1) {\n        search = pathname.substr(searchIndex);\n        pathname = pathname.substr(0, searchIndex);\n    }\n    return {\n        pathname: pathname,\n        search: search === '?' ? '' : search,\n        hash: hash === '#' ? '' : hash,\n        key: '',\n        get href() {\n            return this.pathname + this.search + this.hash;\n        }\n    };\n}\nexports.parsePath = parsePath;\n// /**\n//  * 将一个location对象转为path对象\n//  * @export\n//  * @param {ILocation} location\n//  * @returns {string}\n//  */\n// export function createPath(location: ILocation): string {\n//     const { pathname, search, hash } = location;\n//     let path = pathname || '/';\n//     if (search && search !== '?')\n//         path += search.charAt(0) === '?' ? search : `?${search}`;\n//     if (hash && hash !== '#') path += hash.charAt(0) === '#' ? hash : `#${hash}`;\n//     return path;\n// }\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\nvar g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nfunction __export(m) {\n    for (var p in m) {\n        if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n    }\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(__webpack_require__(0));\nvar History_1 = __webpack_require__(0);\nexports.default = History_1.MyHistory;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar resolve_pathname_1 = __webpack_require__(5);\nvar PathUtils_1 = __webpack_require__(1);\n/**\r\n *\r\n * @export\r\n * @param {string | _Location} path href字符串或者location对象\r\n * @param {any} key 猜测是一个标记location的key\r\n * @param {_Location} currentLocation 当前的location对象，用于解析出相对路径\r\n * @returns\r\n */\nfunction createLocation(path) {\n    var key = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    var currentLocation = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n    var location = void 0;\n    // 如果path是字符串，将其封装成location\n    if (typeof path === 'string') {\n        location = PathUtils_1.parsePath(path);\n    } else {\n        // 如果path不是字符串，认为他是location，\n        // One-arg form: push(location)\n        location = Object.assign({}, path);\n        // 规范化传入的location的pathname、search、hash。如果存在这些数据，索性置为“”，反正后面会根据\n        if (location.pathname === undefined) location.pathname = '';\n        if (location.search) {\n            if (location.search.charAt(0) !== '?') location.search = '?' + location.search;\n        } else {\n            location.search = '';\n        }\n        if (location.hash) {\n            if (location.hash.charAt(0) !== '#') location.hash = '#' + location.hash;\n        } else {\n            location.hash = '';\n        }\n    }\n    try {\n        // 将不符合URL规范的字符做URL编码。如果不能做URL编码抛出异常\n        location.pathname = decodeURI(location.pathname);\n    } catch (e) {\n        if (e instanceof URIError) {\n            throw new URIError('Pathname \"' + location.pathname + '\" could not be decoded. ' + 'This is likely caused by an invalid percent-encoding.');\n        } else {\n            throw e;\n        }\n    }\n    // location的key应该是自定义的内容，用于标记location使用\n    if (key) location.key = key;\n    if (currentLocation) {\n        // Resolve incomplete/relative pathname relative to current location.\n        // 如果传入的当前的location对象，需要用其解析出先对路径\n        if (!location.pathname) {\n            location.pathname = currentLocation.pathname;\n        } else if (location.pathname.charAt(0) !== '/') {\n            location.pathname = resolve_pathname_1.default(location.pathname, currentLocation.pathname);\n        }\n    } else {\n        // When there is no prior location and pathname is empty, set it to /\n        // 如果没有pathname，就用根路径\n        if (!location.pathname) {\n            location.pathname = '/';\n        }\n    }\n    return location;\n}\nexports.createLocation = createLocation;\n// /**\n//  * 判断两个location对象是否相等。这里的key是增加的功能，用于区分两个完全一样的url\n//  * @export\n//  * @param {any} a\n//  * @param {any} b\n//  * @returns\n//  */\n// export function locationsAreEqual(a: _Location, b: _Location) {\n//     return a.href === b.href\n// }\nvar timeStamp = void 0;\nvar count = 0;\n/**\r\n * 创建location的ID\r\n * @export\r\n * @param {number} _timeStamp\r\n * @returns\r\n */\nfunction crateNo(_timeStamp) {\n    if (timeStamp !== _timeStamp) {\n        timeStamp = _timeStamp;\n        count = 0;\n    }\n    return timeStamp * 100 + count++;\n}\nexports.crateNo = crateNo;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\nfunction isAbsolute(pathname) {\n  return pathname.charAt(0) === '/';\n}\n\n// About 1.5x faster than the two-arg version of Array#splice()\nfunction spliceOne(list, index) {\n  for (var i = index, k = i + 1, n = list.length; k < n; i += 1, k += 1) {\n    list[i] = list[k];\n  }\n\n  list.pop();\n}\n\n// This implementation is based heavily on node's url.parse\nfunction resolvePathname(to) {\n  var from = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n  var toParts = to && to.split('/') || [];\n  var fromParts = from && from.split('/') || [];\n\n  var isToAbs = to && isAbsolute(to);\n  var isFromAbs = from && isAbsolute(from);\n  var mustEndAbs = isToAbs || isFromAbs;\n\n  if (to && isAbsolute(to)) {\n    // to is absolute\n    fromParts = toParts;\n  } else if (toParts.length) {\n    // to is relative, drop the filename\n    fromParts.pop();\n    fromParts = fromParts.concat(toParts);\n  }\n\n  if (!fromParts.length) return '/';\n\n  var hasTrailingSlash = void 0;\n  if (fromParts.length) {\n    var last = fromParts[fromParts.length - 1];\n    hasTrailingSlash = last === '.' || last === '..' || last === '';\n  } else {\n    hasTrailingSlash = false;\n  }\n\n  var up = 0;\n  for (var i = fromParts.length; i >= 0; i--) {\n    var part = fromParts[i];\n\n    if (part === '.') {\n      spliceOne(fromParts, i);\n    } else if (part === '..') {\n      spliceOne(fromParts, i);\n      up++;\n    } else if (up) {\n      spliceOne(fromParts, i);\n      up--;\n    }\n  }\n\n  if (!mustEndAbs) for (; up--; up) {\n    fromParts.unshift('..');\n  }if (mustEndAbs && fromParts[0] !== '' && (!fromParts[0] || !isAbsolute(fromParts[0]))) fromParts.unshift('');\n\n  var result = fromParts.join('/');\n\n  if (hasTrailingSlash && result.substr(-1) !== '/') result += '/';\n\n  return result;\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (resolvePathname);\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(setImmediate) {\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.canUseDOM = !!(typeof window !== 'undefined' && window.document && window.document.createElement);\n/**\r\n * 在下一个任务队列中执行\r\n * @export\r\n * @param {Function} cb         回调函数\r\n * @param {Object} [ctx]\r\n */\nfunction nextTick(cb, ctx) {\n    var callback = function callback() {\n        if (typeof cb === 'function') {\n            cb.call(ctx);\n        }\n    };\n    if (typeof setImmediate !== 'undefined') {\n        setImmediate(callback);\n    } else if (typeof MessageChannel !== 'undefined' && (/native code/.test(MessageChannel.toString()) || MessageChannel.toString() === '[object MessageChannelConstructor]')) {\n        var channel = new MessageChannel();\n        var port = channel.port2;\n        channel.port1.onmessage = callback;\n        port.postMessage(1);\n    } else {\n        setTimeout(callback, 0);\n    }\n}\nexports.nextTick = nextTick;\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(7).setImmediate))\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(global) {var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\n__webpack_require__(8);\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(global, process) {(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 6–8\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(9)))\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports) {\n\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\r\n * 反转promise的异步控制的对象模型——Deferred\r\n * @returns\r\n */\n\nvar Deferred = function () {\n    function Deferred() {\n        var _this = this;\n\n        _classCallCheck(this, Deferred);\n\n        /**\r\n         * promise是否已经完成\r\n         * @type {boolean}\r\n         */\n        this.$isFinished = false;\n        //返回的参数\n        this.promise = new Promise(function (resolve, reject) {\n            _this.$resolve = resolve;\n            _this.$reject = reject;\n        });\n    }\n\n    _createClass(Deferred, [{\n        key: \"resolve\",\n\n        /**\r\n         * 对外暴露的接口，promise正常完成\r\n         * @param {T} args\r\n         */\n        value: function resolve(args) {\n            this.$isFinished = true;\n            this.$resolve(args);\n        }\n        /**\r\n         * 对外暴露的接口，promise异常结束\r\n         * @param {any} args\r\n         */\n\n    }, {\n        key: \"reject\",\n        value: function reject(args) {\n            this.$isFinished = true;\n            this.$reject(args);\n        }\n    }, {\n        key: \"isFinished\",\n        get: function get() {\n            return this.$isFinished;\n        }\n    }]);\n\n    return Deferred;\n}();\n\nexports.Deferred = Deferred;\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// index.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap cdf37e9d53edde25ce3a","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst LocationUtils_1 = require(\"./LocationUtils\");\r\nconst PathUtils_1 = require(\"./PathUtils\");\r\nconst DOMUtils_1 = require(\"./DOMUtils\");\r\nconst Deferred_1 = require(\"./Deferred\");\r\nconst MY_ROUTER_HISTORY_GOBACK_INIT = 'MyRouterHistory:initGoback';\r\n// 记录MyHistory在默认window上的实例数，确保constructor仅能够运行一个实例\r\nconst MY_ROUTER_HISTORY_WINDOW_INIT = 'MyRouterHistory:window';\r\nlet locationKey = Symbol('location');\r\n/**\r\n * 用于mixin的基类\r\n */\r\nlet baseHistoryState = {\r\n    push: null,\r\n    replace: null,\r\n    goback: null,\r\n    reload: null,\r\n};\r\nclass MyHistory {\r\n    constructor(_config, _window = window) {\r\n        this._config = _config;\r\n        // 当前history的状态：\r\n        // 0未初始化    history没有完成初始化的时候\r\n        // 1正常        history正常运行中\r\n        // 2修正中      当用户手动修改hash，会被视为一次用户触发的跳转。此次跳转会先退回到goback页面，再前进回跳转的页面（为了保持history在浏览器中仅有两个浏览器记录——当前页面和退回页面），这个过程我们叫修改中\r\n        // 3返回中      当用户要求跳转回退，或者正在回退\r\n        // 4销毁中      在history销毁过程中的状态。\r\n        // 5退出中      当用户要求退出到系统以外，系统会一直触发goback，直到页面刷新为止\r\n        // 6跳转中      当用户要求跳转（包括push、replace、reload）\r\n        // 7跳转中      执行生命周期中\r\n        this._state = Object.assign({}, baseHistoryState, { type: 0, hashChange() { } });\r\n        // 保存location数据的栈\r\n        this._stateStack = [];\r\n        /**\r\n         * 如果在beforeChange生命周期，出现了跳转，会在路由重新回归1的时候执行。\r\n         * 如果_notBusyDef已经存在，即使是在beforeChange生命周期（state为7）的时候，也不可以跳转\r\n         * @private\r\n         * @type {Deferred}\r\n         * @memberOf MyHistory\r\n         */\r\n        this._notBusyDef = null;\r\n        this.onBeforeChange = null;\r\n        this.onChange = null;\r\n        this._win = _window;\r\n        if (this._win[MY_ROUTER_HISTORY_WINDOW_INIT]) {\r\n            // 同一时刻，在默认的window上面，不允许有两个history实例运行\r\n            throw new Error('There are already other undestroyed history instances. Please destroy them before you can create a new history instance.');\r\n        }\r\n        this._config = Object.assign({ gobackName: 'go back', root: '/', insertRoot: true }, _config);\r\n        this._hashchangeHandler = this._hashchangeHandler.bind(this);\r\n        this._initHistory();\r\n    }\r\n    get _stackTop() {\r\n        if (this._stateStack.length) {\r\n            return this._stateStack[this._stateStack.length - 1];\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n    /**\r\n     * 初始化goback的location\r\n     * goback的location有2个作用：\r\n     * 1.用于监听用户的返回事件，当用户点击地址栏的返回按钮，会退回到goback的location。由goback去处理用户注册的goback事件\r\n     * 2.当用户手动修改浏览器的location的hash时候，history会增加一条location记录，这时候myhistory会先退回到goback的location，再前进到用户输入的lactation中，这样可以清除浏览器地址栏的前进按钮\r\n     * @private\r\n     * @param {number} now      初始化时候的时间戳\r\n     * @returns {boolean}       是否是goback处于上一页。返回false表示当前就是goback页面。\r\n     * @memberOf MyHistory\r\n     */\r\n    _initGoback(now) {\r\n        // 先查看是否已经创建好了一个goback的location，因为浏览器中无法查看history对象里面保存的历史记录，所以使用history.state保存这个状态。\r\n        // state里面用于记录当前是否处于goback的下一页。\r\n        // 让goback比当前时间戳小，这样能够判断出是后退\r\n        this._gobackState = this._pathToState('/goback', undefined, 'GOBACK', now - 1);\r\n        let state = this._win.history.state;\r\n        if (state && state.type === 'GOBACK' && sessionStorage[MY_ROUTER_HISTORY_GOBACK_INIT]) {\r\n            // 如果当前页面是goback，表示goback已经初始化完成\r\n            return false;\r\n        }\r\n        else if (state && state.type === 'NORMAL' && sessionStorage[MY_ROUTER_HISTORY_GOBACK_INIT]) {\r\n            // 因为目前还处于goback页面，所有返回false\r\n            return true;\r\n        }\r\n        else {\r\n            sessionStorage[MY_ROUTER_HISTORY_GOBACK_INIT] = true;\r\n            this._replaceState(this._gobackState);\r\n            return false;\r\n        }\r\n    }\r\n    // 初始化URL\r\n    _initHistory() {\r\n        // 创建hash路由\r\n        if (!DOMUtils_1.canUseDOM) {\r\n            throw new Error('Hash history needs a DOM');\r\n        }\r\n        // 获取当前时间戳\r\n        let timeStamp = Date.now();\r\n        // 获取当前的路径，将其转换为合法路径后，\r\n        let initialPath = this._decodePath(this._getHrefToPath());\r\n        let initialLocationState = this._pathToState(initialPath, undefined, 'NORMAL', timeStamp);\r\n        // 初始化goback\r\n        let isGobackNextLocation = this._initGoback(timeStamp);\r\n        // 将当前路径压入栈中\r\n        this._push(initialLocationState, !isGobackNextLocation);\r\n        // 如果第一个节点不等于根的路径，插入根节点到栈底\r\n        if (this._config.insertRoot && this._stackTop.location.href !== this._config.root) {\r\n            this._stateStack.unshift(this._pathToState(this._config.root, undefined, 'NORMAL', timeStamp));\r\n        }\r\n        // 初始化监听器\r\n        this._initEventListener();\r\n        // 全部初始化完成，记录初始化成功\r\n        this._win[MY_ROUTER_HISTORY_WINDOW_INIT] = true;\r\n        this._switchState(1);\r\n        // 使用微队列，用于异步初始化\r\n        Promise.resolve()\r\n            .then(() => {\r\n            let newState = this._readonlyLocation(initialLocationState);\r\n            this._execCallback(this.onChange)('init', null, newState, [], [newState]);\r\n        });\r\n    }\r\n    /**\r\n     * 注册到HashChange事件的监听器。这个函数会在构造器中bind，以在addEventListener保持this不变\r\n     * @private\r\n     * @param {HashChangeEvent} event\r\n     * @memberOf MyHistory\r\n     */\r\n    _hashchangeHandler(event) {\r\n        this._state.hashChange(event);\r\n    }\r\n    _initEventListener() {\r\n        // 注册\r\n        this._win.addEventListener('hashchange', this._hashchangeHandler);\r\n    }\r\n    _destroyEventListener() {\r\n        this._win.removeEventListener('hashchange', this._hashchangeHandler);\r\n    }\r\n    /**\r\n     * 切换状态\r\n     * @private\r\n     * @param {any} stateType\r\n     * @memberOf MyHistory\r\n     */\r\n    _switchState(stateType) {\r\n        // 处理beforeChange中的取消逻辑。如果用户返回false、Error、Function都视为取消跳转。其中Function会在跳转结束后自执行\r\n        let handleCancell = function (result) {\r\n            let isFalse = result === false, isFunction = typeof result === 'function';\r\n            if (isFalse || isFunction) {\r\n                // 这里用任务队列而不用微任务队列，希望整个promise执行完再执行result\r\n                if (isFunction) {\r\n                    DOMUtils_1.nextTick(() => {\r\n                        result.call(this);\r\n                    });\r\n                }\r\n                // 抛出用户取消异常\r\n                let error = new Error('User cancelled');\r\n                error.isCancelled = true;\r\n                throw error;\r\n            }\r\n            else if (result instanceof Error) {\r\n                throw result;\r\n            }\r\n        };\r\n        // 简单原型函数名，增加压缩效率\r\n        let toReadonly = this._readonlyLocation.bind(this);\r\n        switch (stateType) {\r\n            case (1):\r\n                this._state = {\r\n                    type: 1,\r\n                    push: async (path, data) => {\r\n                        this._checkData(data);\r\n                        // 先切换到状态6，保护在跳转过程中不受其他操作影响\r\n                        this._switchState(6);\r\n                        try {\r\n                            let state = this._pathToState(path, data, 'NORMAL');\r\n                            let newLocation = toReadonly(state);\r\n                            let oldLocation = toReadonly(this._stackTop);\r\n                            let result = await (this._execCallback(this.onBeforeChange)('push', oldLocation, newLocation, [], [newLocation]));\r\n                            // 处理取消情况\r\n                            handleCancell(result);\r\n                            this._push(state);\r\n                            // 确保跳转完成\r\n                            await new Promise(r => DOMUtils_1.nextTick(r));\r\n                            await (this._execCallback(this.onChange)('push', oldLocation, newLocation, [], [newLocation]));\r\n                            this._switchState(1);\r\n                            return this._readonlyLocation(state);\r\n                        }\r\n                        catch (e) {\r\n                            // 完成后切换状态1\r\n                            this._switchState(1);\r\n                            throw e;\r\n                        }\r\n                    },\r\n                    replace: async (path, data) => {\r\n                        this._checkData(data);\r\n                        this._switchState(6);\r\n                        try {\r\n                            let now = Date.now();\r\n                            let state = this._pathToState(path, data, 'NORMAL', now);\r\n                            let newLocation = toReadonly(state);\r\n                            let oldLocation = toReadonly(this._stackTop);\r\n                            let result = await (this._execCallback(this.onBeforeChange)('replace', oldLocation, newLocation, [oldLocation], [newLocation]));\r\n                            // 处理取消情况\r\n                            handleCancell(result);\r\n                            this._replace(state);\r\n                            // 确保跳转完成\r\n                            await new Promise(r => DOMUtils_1.nextTick(r));\r\n                            this._switchState(1);\r\n                            await this._execCallback(this.onChange)('replace', oldLocation, newLocation, [oldLocation], [newLocation]);\r\n                            return this._readonlyLocation(state);\r\n                        }\r\n                        catch (e) {\r\n                            // 完成后切换状态1\r\n                            this._switchState(1);\r\n                            throw e;\r\n                        }\r\n                    },\r\n                    goback: async (n = 1) => {\r\n                        // 先执行生命周期\r\n                        this._switchState(3);\r\n                        try {\r\n                            // 当前页面\r\n                            let oldLocation;\r\n                            // 丢弃的页面\r\n                            let discardLoctions;\r\n                            // 退回到的页面\r\n                            let newState;\r\n                            // 新建页面\r\n                            let newLocation;\r\n                            // 是否有符合退回条件的页面，如果没有插入一条\r\n                            let needInclude = false;\r\n                            // 判断是否符合页面的条件\r\n                            let fn;\r\n                            if (typeof n === 'number') {\r\n                                // 如果退回的步数大于栈的长度，则给缓存插入一个根页面，让用户先退回到根页面\r\n                                if (n <= 0) {\r\n                                    return null;\r\n                                }\r\n                                else if (n >= this._stateStack.length) {\r\n                                    fn = () => false;\r\n                                }\r\n                                else {\r\n                                    fn = (location, index) => this._stateStack.length - index - 1 === n;\r\n                                }\r\n                            }\r\n                            else if (typeof n === 'string') {\r\n                                // 查询有没有href等于n的页面，如果没有就退回到起点，然后插入一条记录\r\n                                fn = (location) => location.href === this._pathToLocation(n).href;\r\n                            }\r\n                            else if (typeof n === 'function') {\r\n                                fn = n;\r\n                            }\r\n                            let index = this._stateStack.findIndex((item, index) => fn(toReadonly(item), index));\r\n                            oldLocation = toReadonly(this._stackTop);\r\n                            if (index === -1) {\r\n                                // 如果没有找到，就插入一条根节点进去。但是如果查询的是指定页面，就将指定页面放进去\r\n                                newState = this._pathToState(this._pathToLocation(typeof n === 'string' ? n : this._config.root), 'NORMAL', undefined);\r\n                                newLocation = toReadonly(newState);\r\n                                discardLoctions = this._stateStack.map(item => toReadonly(item));\r\n                                needInclude = true;\r\n                            }\r\n                            else {\r\n                                // 取出退回位置的state\r\n                                newState = this._stateStack[index];\r\n                                newLocation = toReadonly(newState);\r\n                                discardLoctions = this._stateStack.slice(index + 1).map(item => toReadonly(item)).reverse();\r\n                            }\r\n                            let result = await (this._execCallback(this.onBeforeChange)('goback', oldLocation, newLocation, discardLoctions, needInclude ? [newLocation] : []));\r\n                            // 处理取消情况\r\n                            handleCancell(result);\r\n                            this._goback(discardLoctions.length, needInclude ? newState : null, false);\r\n                            // 确保跳转完成\r\n                            await new Promise(r => DOMUtils_1.nextTick(r));\r\n                            this._switchState(1);\r\n                            await (this._execCallback(this.onChange)('goback', oldLocation, newLocation, discardLoctions, needInclude ? [newLocation] : []));\r\n                            return this._readonlyLocation(newState);\r\n                        }\r\n                        catch (e) {\r\n                            // 完成后切换状态1\r\n                            this._switchState(1);\r\n                            throw e;\r\n                        }\r\n                    },\r\n                    reload: () => {\r\n                        return this._state.replace(this._stackTop.location.href);\r\n                    },\r\n                    hashChange: (event) => {\r\n                        let state = this._win.history.state;\r\n                        if (state && state.type === 'GOBACK') {\r\n                            // 用户手动退回，前进一个页面，让history的修正\r\n                            this._pushState(this._stackTop);\r\n                            this._state.goback(1);\r\n                        }\r\n                        else if (!state && this._getHrefToPath(event.oldURL) === this._stateStack[this._stateStack.length - 1].location.href) {\r\n                            // 判断是否是用户手动修改hash跳转，或者a标签切换hash。判断方法如下：\r\n                            // 1.当前history没有state，或者state不等于State变量\r\n                            // 2.oldURL等于当前_stateStack栈顶的href（即使这样也不能确定该页面是从系统页面栈顶跳转过来的，但是没有其他更好的方式）\r\n                            // 先切户到手动修正用户修改url的状态2，保留用户要跳转的url\r\n                            this._switchState(2);\r\n                            this._stateData = this._getHrefToPath(event.newURL);\r\n                            // 后退两次，退回到goback页面\r\n                            this._win.history.go(-2);\r\n                        }\r\n                        else {\r\n                            // 如果不是从栈顶的url转跳转到该状态，就无法确定返回页面就在当前页面的前面，因此触发修正\r\n                            this._correct();\r\n                            // 纠正后重新后退\r\n                            this._win.history.back();\r\n                        }\r\n                    }\r\n                };\r\n                // 重新置回1，设置_notBusyDef为resolve\r\n                if (this._notBusyDef) {\r\n                    this._notBusyDef.resolve(undefined);\r\n                    this._notBusyDef = null;\r\n                }\r\n                break;\r\n            case (2):\r\n                this._state = Object.assign({ type: 2 }, baseHistoryState, { hashChange: (event) => {\r\n                        // 对纠正的处理步骤\r\n                        // 1. 一直后退，直到后退到goback页面\r\n                        // 2. 前进到gobackNext页面，把用户给出的地址放到gobackNext页面中。\r\n                        let state = this._win.history.state;\r\n                        if (state && state.type === 'NORMAL') {\r\n                            // 如果当前处于gobackNext页面，表示上一页就是goback，则退回，这主要是为了修改ios的safari那种无法使用go(-2)的浏览器时候的处理方式\r\n                            this._win.history.back();\r\n                        }\r\n                        else if (state && state.type === 'GOBACK') {\r\n                            // 如果已经在goback页面了，则跳转到用户手输入的地址\r\n                            let now = Date.now();\r\n                            let location = this._pathToLocation(this._stateData, now);\r\n                            // 切回正在状态，这样就完成了对页面的修正\r\n                            this._switchState(1);\r\n                            this._pushState(this._stackTop);\r\n                            this._state.push(location.href);\r\n                        }\r\n                        else {\r\n                            // 在纠正的时候，如果跳转到了goback和gobackNext以外的页面，视为异常，进行异常纠正\r\n                            this._correct();\r\n                            // 纠正后重新后退\r\n                            this._win.history.back();\r\n                        }\r\n                    } });\r\n                break;\r\n            case (3):\r\n            case (6):\r\n                this._state = Object.assign({ type: stateType }, baseHistoryState, { hashChange: (event) => {\r\n                        if (!this._win.history.state && this._getHrefToPath(event.oldURL) === this._stateStack[this._stateStack.length - 1].location.href) {\r\n                            // 如果用户在此期间手动修改url，直接纠正\r\n                            this._correct();\r\n                        }\r\n                        else {\r\n                            // 用户手动退回，前进一个页面，让history的修正\r\n                            this._pushState(this._stackTop);\r\n                        }\r\n                    } });\r\n                break;\r\n            case (4):\r\n            case (5):\r\n                this._state = Object.assign({ type: stateType }, baseHistoryState, { hashChange: (event) => {\r\n                        this._win.history.back();\r\n                    } });\r\n                break;\r\n            case (7):\r\n                this._state = {\r\n                    type: stateType,\r\n                    hashChange: (event) => {\r\n                        this._win.history.back();\r\n                    },\r\n                    push: async (path, state) => {\r\n                        this._notBusyDef = new Deferred_1.Deferred;\r\n                        return this._notBusyDef.promise.then(() => {\r\n                            return this.push(path, state);\r\n                        });\r\n                    },\r\n                    replace: async (path, state) => {\r\n                        this._notBusyDef = new Deferred_1.Deferred;\r\n                        return this._notBusyDef.promise.then(() => {\r\n                            return this.replace(path, state);\r\n                        });\r\n                    },\r\n                    goback: async (arg) => {\r\n                        this._notBusyDef = new Deferred_1.Deferred;\r\n                        return this._notBusyDef.promise.then(() => {\r\n                            return this.goback(arg);\r\n                        });\r\n                    },\r\n                    reload: async () => {\r\n                        this._notBusyDef = new Deferred_1.Deferred;\r\n                        return this._notBusyDef.promise.then(() => {\r\n                            return this.reload();\r\n                        });\r\n                    },\r\n                };\r\n                break;\r\n        }\r\n    }\r\n    /**\r\n     * 将用户给定的path转为系统显示的path\r\n     * @private\r\n     * @param {string} path         用户给定的path\r\n     * @returns {string}            系统显示的path\r\n     * @memberOf MyHistory\r\n     */\r\n    _encodePath(path) {\r\n        return PathUtils_1.addLeadingSlash(path);\r\n    }\r\n    /**\r\n     * 将系统显示的path转为用户给定的path\r\n     * @private\r\n     * @param {string} path         系统显示的path\r\n     * @returns {string}            用户给定的path\r\n     * @memberOf MyHistory\r\n     */\r\n    _decodePath(path) {\r\n        return PathUtils_1.addLeadingSlash(path);\r\n    }\r\n    // 获取hash中保存的路径。\r\n    _getHrefToPath(href = this._win.location.href) {\r\n        // We can't use window.location.hash here because it's not\r\n        // consistent across browsers - Firefox will pre-decode it!\r\n        const hashIndex = href.indexOf('#');\r\n        return hashIndex === -1 ? '' : href.substring(hashIndex + 1);\r\n    }\r\n    // 检查data，确保data可以序列化\r\n    _checkData(data) {\r\n        if (data != null) {\r\n            JSON.stringify(data);\r\n        }\r\n    }\r\n    // 检查路由是否处于可以跳转状态（state为1或7，如果处于7仅能跳转1次）\r\n    _checkState() {\r\n        if (this.isBusy) {\r\n            let error = new Error('MyHistory busy');\r\n            error.isBusy = true;\r\n            throw error;\r\n        }\r\n    }\r\n    /**\r\n     * 将给定的path封装成一个location\r\n     * @private\r\n     * @param {string} path\r\n     * @param {number} [timeStamp=Date.now()]\r\n     * @returns\r\n     * @memberOf MyHistory\r\n     */\r\n    _pathToLocation(path, timeStamp = Date.now()) {\r\n        path = this._decodePath(path);\r\n        // 创建的location\r\n        return LocationUtils_1.createLocation(path, timeStamp + '');\r\n    }\r\n    _pathToState(path, data = null, type, timeStamp) {\r\n        let location;\r\n        if (typeof path === 'object') {\r\n            location = path;\r\n        }\r\n        else {\r\n            location = this._pathToLocation(path, timeStamp);\r\n        }\r\n        return {\r\n            location: location,\r\n            type,\r\n            timeStamp,\r\n            data: JSON.parse(JSON.stringify(data))\r\n        };\r\n    }\r\n    _readonlyLocation(state) {\r\n        let data = state.data;\r\n        let location = Object.assign({}, state.location, { state: data });\r\n        // 只读对象\r\n        let readonlyLocation = {\r\n            [locationKey]: location\r\n        };\r\n        // 通过只设置getter不设置setter实现只读。不使用freeze是因为freeze在严格模式下赋值会抛出错误。\r\n        Object.keys(location).forEach((key) => {\r\n            Object.defineProperty(readonlyLocation, key, {\r\n                get() {\r\n                    return this[locationKey][key];\r\n                },\r\n                set() {\r\n                },\r\n                enumerable: true,\r\n            });\r\n        });\r\n        return readonlyLocation;\r\n    }\r\n    async _push(state, push = false) {\r\n        if (push) {\r\n            let tempTitle = this._win.document.title;\r\n            // 修改title为gobackName，这样地址栏显示的时候会是一个给定的gobackName，而不是页面的title\r\n            this._win.document.title = this._config.gobackName;\r\n            this._pushState(state);\r\n            this._win.document.title = tempTitle;\r\n        }\r\n        else {\r\n            this._replaceState(state);\r\n        }\r\n        this._stateStack.push(state);\r\n    }\r\n    async _replace(state, push = false) {\r\n        this._stateStack.pop();\r\n        this._stateStack.push(state);\r\n        if (push) {\r\n            let tempTitle = this._win.document.title;\r\n            // 修改title为gobackName，这样地址栏显示的时候会是一个给定的gobackName，而不是页面的title\r\n            this._win.document.title = this._config.gobackName;\r\n            this._pushState(state);\r\n            this._win.document.title = tempTitle;\r\n        }\r\n        else {\r\n            this._replaceState(state);\r\n        }\r\n    }\r\n    _goback(n, state = null, push = false) {\r\n        if (n <= 0) {\r\n            return;\r\n        }\r\n        this._stateStack.splice(Math.max(0, this._stateStack.length - n));\r\n        if (state) {\r\n            this._stateStack.push(state);\r\n        }\r\n        let lastState = this._stateStack[this._stateStack.length - 1];\r\n        if (push) {\r\n            this._pushState(lastState);\r\n        }\r\n        else {\r\n            this._replaceState(lastState);\r\n        }\r\n    }\r\n    _replaceState(state) {\r\n        this._win.history.replaceState(state, null, '#' + this._encodePath(state.location.href));\r\n    }\r\n    _pushState(state) {\r\n        this._win.history.pushState(state, null, '#' + this._encodePath(state.location.href));\r\n    }\r\n    /**\r\n     * 当用处于未知页面（既不是goback页面，也不是normal页面时候），触发纠正\r\n     */\r\n    _correct() {\r\n        // 暂时先记录日志\r\n        console.error('异常', this._stateStack, this._win.history.state, location.hash);\r\n        // 初始化goback\r\n        let isGobackNextLocation = this._initGoback(this._gobackState.timeStamp);\r\n        // 初始化当前页面\r\n        this._push(this._stackTop, !isGobackNextLocation);\r\n    }\r\n    push(path, data) {\r\n        this._checkState();\r\n        return this._state.push(path, data);\r\n    }\r\n    replace(path, data) {\r\n        this._checkState();\r\n        return this._state.replace(path, data);\r\n    }\r\n    goback(n) {\r\n        this._checkState();\r\n        return this._state.goback(n);\r\n    }\r\n    reload() {\r\n        this._checkState();\r\n        return this._state.reload();\r\n    }\r\n    async destroy() {\r\n        this._destroyEventListener();\r\n        this.onBeforeChange = null;\r\n        this.onChange = null;\r\n        if (this._notBusyDef) {\r\n            let error = new Error('User cancelled');\r\n            error.isCancelled = true;\r\n            this._notBusyDef.reject(error);\r\n            this._notBusyDef = null;\r\n        }\r\n        sessionStorage[MY_ROUTER_HISTORY_GOBACK_INIT] = false;\r\n        let goGoBackPage = async () => {\r\n            if (this._win.history.state && this._win.history.state.type === 'NORMAL') {\r\n                this._win.history.back();\r\n                await new Promise(r => setTimeout(r, 50));\r\n                await goGoBackPage();\r\n            }\r\n            else if (this._win.history.state) {\r\n                this._win.history.replaceState(null, null, '#' + this._stackTop.location.href);\r\n                this._win.location.hash = '#' + this._stackTop.location.href;\r\n                await new Promise(r => setTimeout(r, 50));\r\n                await goGoBackPage();\r\n            }\r\n            else {\r\n                await new Promise(r => setTimeout(r, 50));\r\n            }\r\n        };\r\n        await goGoBackPage();\r\n        // 延时，等pushState执行完\r\n        this._stateStack = null;\r\n        this._config = null;\r\n        this._stateData = null;\r\n        this._state = null;\r\n        if (this._win === window) {\r\n            delete this._win[MY_ROUTER_HISTORY_WINDOW_INIT];\r\n        }\r\n        this._win = null;\r\n    }\r\n    get stack() {\r\n        return this._stateStack.map(state => this._readonlyLocation(state));\r\n    }\r\n    get length() {\r\n        return this._stateStack.length;\r\n    }\r\n    get isBusy() {\r\n        return (this._state.type !== 1 && this._state.type !== 7) || (this._notBusyDef && this._state.type === 7);\r\n    }\r\n    get location() {\r\n        return this._readonlyLocation(this._stackTop);\r\n    }\r\n    _execCallback(callback) {\r\n        if (typeof callback === 'function') {\r\n            return (async (...args) => {\r\n                let state = this._state.type;\r\n                try {\r\n                    this._switchState(7);\r\n                    let result = await callback.apply(this, args);\r\n                    this._switchState(state);\r\n                    return result;\r\n                }\r\n                catch (e) {\r\n                    this._switchState(state);\r\n                    throw e;\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            return (() => Promise.resolve());\r\n        }\r\n    }\r\n}\r\nexports.MyHistory = MyHistory;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/History.ts","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * 增加'/'到path\r\n * @export\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\nfunction addLeadingSlash(path) {\r\n    return path.charAt(0) === '/' ? path : '/' + path;\r\n}\r\nexports.addLeadingSlash = addLeadingSlash;\r\n// /**\r\n//  * 移除path的根'/'\r\n//  * @export\r\n//  * @param {string} path\r\n//  * @returns {string}\r\n//  */\r\n// export function stripLeadingSlash(path: string): string {\r\n//     return path.charAt(0) === '/' ? path.substr(1) : path;\r\n// }\r\n// /**\r\n//  * 移除path最后的'/'\r\n//  * @export\r\n//  * @param {string} path\r\n//  * @returns {string}\r\n//  */\r\n// export function stripTrailingSlash(path: string): string {\r\n//     return path.charAt(path.length - 1) === '/' ? path.slice(0, -1) : path;\r\n// }\r\n/**\r\n * 将一个path转为location对象形式\r\n * @export\r\n * @param {string} path\r\n * @param {any} state\r\n * @returns {ILocation}\r\n */\r\nfunction parsePath(path) {\r\n    let pathname = path || '/';\r\n    let search = '';\r\n    let hash = '';\r\n    const hashIndex = pathname.indexOf('#');\r\n    if (hashIndex !== -1) {\r\n        hash = pathname.substr(hashIndex);\r\n        pathname = pathname.substr(0, hashIndex);\r\n    }\r\n    const searchIndex = pathname.indexOf('?');\r\n    if (searchIndex !== -1) {\r\n        search = pathname.substr(searchIndex);\r\n        pathname = pathname.substr(0, searchIndex);\r\n    }\r\n    return {\r\n        pathname,\r\n        search: search === '?' ? '' : search,\r\n        hash: hash === '#' ? '' : hash,\r\n        key: '',\r\n        get href() {\r\n            return this.pathname + this.search + this.hash;\r\n        }\r\n    };\r\n}\r\nexports.parsePath = parsePath;\r\n// /**\r\n//  * 将一个location对象转为path对象\r\n//  * @export\r\n//  * @param {ILocation} location\r\n//  * @returns {string}\r\n//  */\r\n// export function createPath(location: ILocation): string {\r\n//     const { pathname, search, hash } = location;\r\n//     let path = pathname || '/';\r\n//     if (search && search !== '?')\r\n//         path += search.charAt(0) === '?' ? search : `?${search}`;\r\n//     if (hash && hash !== '#') path += hash.charAt(0) === '#' ? hash : `#${hash}`;\r\n//     return path;\r\n// }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/PathUtils.ts","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 2\n// module chunks = 0","\"use strict\";\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n__export(require(\"./History\"));\r\nconst History_1 = require(\"./History\");\r\nexports.default = History_1.MyHistory;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst resolve_pathname_1 = require(\"resolve-pathname\");\r\nconst PathUtils_1 = require(\"./PathUtils\");\r\n/**\r\n *\r\n * @export\r\n * @param {string | _Location} path href字符串或者location对象\r\n * @param {any} key 猜测是一个标记location的key\r\n * @param {_Location} currentLocation 当前的location对象，用于解析出相对路径\r\n * @returns\r\n */\r\nfunction createLocation(path, key = '', currentLocation = null) {\r\n    let location;\r\n    // 如果path是字符串，将其封装成location\r\n    if (typeof path === 'string') {\r\n        location = PathUtils_1.parsePath(path);\r\n    }\r\n    else {\r\n        // 如果path不是字符串，认为他是location，\r\n        // One-arg form: push(location)\r\n        location = Object.assign({}, path);\r\n        // 规范化传入的location的pathname、search、hash。如果存在这些数据，索性置为“”，反正后面会根据\r\n        if (location.pathname === undefined)\r\n            location.pathname = '';\r\n        if (location.search) {\r\n            if (location.search.charAt(0) !== '?')\r\n                location.search = '?' + location.search;\r\n        }\r\n        else {\r\n            location.search = '';\r\n        }\r\n        if (location.hash) {\r\n            if (location.hash.charAt(0) !== '#')\r\n                location.hash = '#' + location.hash;\r\n        }\r\n        else {\r\n            location.hash = '';\r\n        }\r\n    }\r\n    try {\r\n        // 将不符合URL规范的字符做URL编码。如果不能做URL编码抛出异常\r\n        location.pathname = decodeURI(location.pathname);\r\n    }\r\n    catch (e) {\r\n        if (e instanceof URIError) {\r\n            throw new URIError('Pathname \"' +\r\n                location.pathname +\r\n                '\" could not be decoded. ' +\r\n                'This is likely caused by an invalid percent-encoding.');\r\n        }\r\n        else {\r\n            throw e;\r\n        }\r\n    }\r\n    // location的key应该是自定义的内容，用于标记location使用\r\n    if (key)\r\n        location.key = key;\r\n    if (currentLocation) {\r\n        // Resolve incomplete/relative pathname relative to current location.\r\n        // 如果传入的当前的location对象，需要用其解析出先对路径\r\n        if (!location.pathname) {\r\n            location.pathname = currentLocation.pathname;\r\n        }\r\n        else if (location.pathname.charAt(0) !== '/') {\r\n            location.pathname = resolve_pathname_1.default(location.pathname, currentLocation.pathname);\r\n        }\r\n    }\r\n    else {\r\n        // When there is no prior location and pathname is empty, set it to /\r\n        // 如果没有pathname，就用根路径\r\n        if (!location.pathname) {\r\n            location.pathname = '/';\r\n        }\r\n    }\r\n    return location;\r\n}\r\nexports.createLocation = createLocation;\r\n// /**\r\n//  * 判断两个location对象是否相等。这里的key是增加的功能，用于区分两个完全一样的url\r\n//  * @export\r\n//  * @param {any} a\r\n//  * @param {any} b\r\n//  * @returns\r\n//  */\r\n// export function locationsAreEqual(a: _Location, b: _Location) {\r\n//     return a.href === b.href\r\n// }\r\nlet timeStamp;\r\nlet count = 0;\r\n/**\r\n * 创建location的ID\r\n * @export\r\n * @param {number} _timeStamp\r\n * @returns\r\n */\r\nfunction crateNo(_timeStamp) {\r\n    if (timeStamp !== _timeStamp) {\r\n        timeStamp = _timeStamp;\r\n        count = 0;\r\n    }\r\n    return timeStamp * 100 + count++;\r\n}\r\nexports.crateNo = crateNo;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/LocationUtils.ts","function isAbsolute(pathname) {\n  return pathname.charAt(0) === '/';\n}\n\n// About 1.5x faster than the two-arg version of Array#splice()\nfunction spliceOne(list, index) {\n  for (var i = index, k = i + 1, n = list.length; k < n; i += 1, k += 1) {\n    list[i] = list[k];\n  }\n\n  list.pop();\n}\n\n// This implementation is based heavily on node's url.parse\nfunction resolvePathname(to) {\n  var from = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n  var toParts = to && to.split('/') || [];\n  var fromParts = from && from.split('/') || [];\n\n  var isToAbs = to && isAbsolute(to);\n  var isFromAbs = from && isAbsolute(from);\n  var mustEndAbs = isToAbs || isFromAbs;\n\n  if (to && isAbsolute(to)) {\n    // to is absolute\n    fromParts = toParts;\n  } else if (toParts.length) {\n    // to is relative, drop the filename\n    fromParts.pop();\n    fromParts = fromParts.concat(toParts);\n  }\n\n  if (!fromParts.length) return '/';\n\n  var hasTrailingSlash = void 0;\n  if (fromParts.length) {\n    var last = fromParts[fromParts.length - 1];\n    hasTrailingSlash = last === '.' || last === '..' || last === '';\n  } else {\n    hasTrailingSlash = false;\n  }\n\n  var up = 0;\n  for (var i = fromParts.length; i >= 0; i--) {\n    var part = fromParts[i];\n\n    if (part === '.') {\n      spliceOne(fromParts, i);\n    } else if (part === '..') {\n      spliceOne(fromParts, i);\n      up++;\n    } else if (up) {\n      spliceOne(fromParts, i);\n      up--;\n    }\n  }\n\n  if (!mustEndAbs) for (; up--; up) {\n    fromParts.unshift('..');\n  }if (mustEndAbs && fromParts[0] !== '' && (!fromParts[0] || !isAbsolute(fromParts[0]))) fromParts.unshift('');\n\n  var result = fromParts.join('/');\n\n  if (hasTrailingSlash && result.substr(-1) !== '/') result += '/';\n\n  return result;\n}\n\nexport default resolvePathname;\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/workspace/web/my-router/node_modules/resolve-pathname/index.js\n// module id = 5\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.canUseDOM = !!(typeof window !== 'undefined' &&\r\n    window.document &&\r\n    window.document.createElement);\r\n/**\r\n * 在下一个任务队列中执行\r\n * @export\r\n * @param {Function} cb         回调函数\r\n * @param {Object} [ctx]\r\n */\r\nfunction nextTick(cb, ctx) {\r\n    let callback = () => {\r\n        if (typeof cb === 'function') {\r\n            cb.call(ctx);\r\n        }\r\n    };\r\n    if (typeof setImmediate !== 'undefined') {\r\n        setImmediate(callback);\r\n    }\r\n    else if (typeof MessageChannel !== 'undefined'\r\n        && (/native code/.test(MessageChannel.toString()) || MessageChannel.toString() === '[object MessageChannelConstructor]')) {\r\n        const channel = new MessageChannel();\r\n        const port = channel.port2;\r\n        channel.port1.onmessage = callback;\r\n        port.postMessage(1);\r\n    }\r\n    else {\r\n        setTimeout(callback, 0);\r\n    }\r\n}\r\nexports.nextTick = nextTick;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/DOMUtils.ts","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/timers-browserify/main.js\n// module id = 7\n// module chunks = 0","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 6–8\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/setimmediate/setImmediate.js\n// module id = 8\n// module chunks = 0","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/process/browser.js\n// module id = 9\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * 反转promise的异步控制的对象模型——Deferred\r\n * @returns\r\n */\r\nclass Deferred {\r\n    constructor() {\r\n        /**\r\n         * promise是否已经完成\r\n         * @type {boolean}\r\n         */\r\n        this.$isFinished = false;\r\n        //返回的参数\r\n        this.promise = new Promise((resolve, reject) => {\r\n            this.$resolve = resolve;\r\n            this.$reject = reject;\r\n        });\r\n    }\r\n    get isFinished() {\r\n        return this.$isFinished;\r\n    }\r\n    /**\r\n     * 对外暴露的接口，promise正常完成\r\n     * @param {T} args\r\n     */\r\n    resolve(args) {\r\n        this.$isFinished = true;\r\n        this.$resolve(args);\r\n    }\r\n    /**\r\n     * 对外暴露的接口，promise异常结束\r\n     * @param {any} args\r\n     */\r\n    reject(args) {\r\n        this.$isFinished = true;\r\n        this.$reject(args);\r\n    }\r\n}\r\nexports.Deferred = Deferred;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Deferred.ts"],"sourceRoot":""}